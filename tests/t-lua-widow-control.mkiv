\startmodule[lua-widow-control]

\clubpenalty=3
\widowpenalty=5

\ctxlua{require "lua-widow-control"}

\define\LuaWidowControlEnable{\directlua{lwc.enable_callbacks()}}
\define\LuaWidowControlDisable{\directlua{lwc.disable_callbacks()}}

\LuaWidowControlEnable

\unprotect
    % This is a terrible idea, but it's an easy way to stop the penalies from being reset
    \expandafter\def\csname\??setup:*default\endcsname{\relax}
\protect

\stopmodule
